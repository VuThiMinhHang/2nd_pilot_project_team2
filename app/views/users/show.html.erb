<% provide(:title, @user.name) %>
<div class="row">
  <aside class="span4">
    <section>
      <%= render 'shared/user_info', user: @user %>
      <% if signed_in? %>
        <% unless current_user?(@user) || current_user.requested_friends.include?(@user) || current_user.friends.include?(@user) || current_user.pending_friends.include?(@user) %>
          <%= link_to "Add friend", user_friendships_path(@user.id), method: :post, :class => 'btn btn-mini' %>
        <% end %>
      <% end %>
    </section>
    <% if current_user.friends.include?(@user) || current_user?(@user)%>
      <section>
        <%= render 'shared/micropost_form', user: @user %>
      </section>
    <% end %>
    <section>
      <%= render 'shared/user_profile', user: @user %>
    </section>
  </aside>
  <div class="span8">
    <ul class="posts">
      <% if current_user?(@user) %>
        <h3> My page</h3>
        <% @microposts.each do |micropost| %>
          <% if micropost.friend_id == current_user.id %>
            <% unless micropost.user_id == current_user.id %>
              <%= micropost.user.name %> TO <%= current_user.name %>
            <% end %>          
            <%= render "shared/list_microposts", micropost: micropost %>
          <% end %> 
        <% end %>
      <% else %>
        <h3> Time line </h3>
        <% @microposts.each do |micropost| %>
          <% if micropost.friend_id == @user.id && micropost.is_public? %>
            <% unless micropost.user_id == @user.id %>
              <%= micropost.user.name %> TO <%= @user.name %>
            <% end %>
            <%= render "shared/list_microposts", micropost: micropost %>
          <% end %>
        <% end %>
      <% end %>
    </ul>
  </div>
</div>